<!DOCTYPE html>
<!-- http://net.tutsplus.com/tutorials/javascript-ajax/build-a-contacts-manager-using-backbone-js-part-1/ -->
<html>
    <body>
        <div id="blog"></div>
        <!-- the only dependencies of backbone is underscore -->
        <script src="static/jquery-1.8.2.min.js"></script>
        <script src="static/underscore-min.js"></script>
        <script src="static/backbone-min.js"></script>
        <script>
        $(function() {
            var Item = Backbone.Model.extend({
                urlRoot: 'http://localhost:5000/item',
                defaults: {
                    title: 'not yet ready',
                    text:  '...'
                },
                initialize: function() {
                }

            });

            // model is an attribute automatically created
            // when new View({model: todo}) is executed
            var View = Backbone.View.extend({
                el: $('#blog'),// attach to #blog this rendered view
                template: _.template($('#item-template').html()),

                initialize: function() {
                    this.render();
                    this.model.on("change", this.render, this);
                },

                render: function() {
                    this.$el.html(this.template(this.model.toJSON()));

                    return this;
                }
            });

            var item = new Item;
            item.fetch();
            var view = new View({model: item});

            var myRouter = Backbone.Router.extend({
                routes: {
                    "dir/:name": "doRoute"
                },
                doRoute: function(name) {
                    alert(name);
                }
            });
            var router = new myRouter();
            // must be called this below in order to make the router works
            Backbone.history.start();

        });

        </script>
  <!-- Templates -->

  <!-- 'text' variable is printes as is, not HTML escaped -->
  <script type="text/template" id="item-template">
    <h1><%- title %></h1>
    <article><%= text %></article>
  </script>
    </body>
</html>
